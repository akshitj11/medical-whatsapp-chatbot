<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mediaware</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Roboto', 'Google Sans', sans-serif;
            background-color: #fef5e9; /* A richer, sun-kissed beige background */
        }

        #header-title {
            font-family: 'Google Sans', sans-serif;
            color: #6d5d4b; /* A richer, warm brown for text */
        }

        .chat-container {
            height: calc(100vh - 8rem); /* Adjust height for header and input */
        }
        
        .user-message-container {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 1rem;
        }

        .bot-message-container {
            display: flex;
            justify-content: flex-start;
            margin-bottom: 1rem;
        }
        
        .message-bubble {
            max-width: 80%;
            padding: 1rem;
            border-radius: 1.5rem;
            line-height: 1.5;
        }
        
        .user-message {
            background-color: #f4dcc7; /* Soft terracotta for user messages */
            color: #6d5d4b;
            border-bottom-right-radius: 0.5rem;
        }

        .bot-message {
            background-color: #fef5e9; /* Same as body for bot */
            color: #6d5d4b;
            border: 1px solid #f2e9d8; /* Softer border to match new background */
            border-bottom-left-radius: 0.5rem;
        }

        .input-area-container {
            background: #fef5e9;
            border-radius: 1.5rem;
            box-shadow: 0 1px 6px rgba(0, 0, 0, 0.08);
            padding: 0.5rem 1rem;
        }

        .button-style {
             color: #a79a8e; /* Subtly warmer button color */
        }
        .button-style:hover {
            color: #c88a65; /* Warm terracotta on hover for a comforting accent */
        }

        /* Voice Recording Animation Styles */
        .recording-animation {
            animation: pulse-ring 1.5s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }

        @keyframes pulse-ring {
            0% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);
            }
            70% {
                transform: scale(1);
                box-shadow: 0 0 0 10px rgba(239, 68, 68, 0);
            }
            100% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0);
            }
        }
        
        /* Custom Language Panel Animation */
        #language-panel {
            transform-origin: top;
            transition: transform 0.2s ease-out, opacity 0.2s ease-out;
        }
    </style>
</head>
<body class="flex flex-col h-screen">

    <!-- Header & Language Selector -->
    <header class="p-4 flex justify-between items-center w-full max-w-4xl mx-auto">
        <h1 id="header-title" class="text-xl font-bold">Healthcare Chatbot</h1>
        <div class="relative" id="custom-language-selector">
            <button id="language-selector-button" type="button" class="bg-transparent border border-[#e0d5c4] text-[#6d5d4b] text-sm rounded-lg focus:ring-amber-500 focus:border-amber-500 flex items-center justify-between w-full p-2">
                <span id="selected-language-text">English</span>
                <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </button>
            <div id="language-panel" class="absolute right-0 mt-2 w-48 bg-[#fef5e9] border border-[#e0d5c4] rounded-lg shadow-lg z-10 hidden transform scale-y-0 opacity-0">
                <div class="p-1 max-h-60 overflow-y-auto">
                    <a href="#" class="block px-4 py-2 text-sm text-[#6d5d4b] hover:bg-[#f4dcc7] rounded-md" data-lang="en">English</a>
                    <a href="#" class="block px-4 py-2 text-sm text-[#6d5d4b] hover:bg-[#f4dcc7] rounded-md" data-lang="hi-EN">Hinglish</a>
                    <a href="#" class="block px-4 py-2 text-sm text-[#6d5d4b] hover:bg-[#f4dcc7] rounded-md" data-lang="hi">рд╣рд┐рдиреНрджреА (Hindi)</a>
                    <a href="#" class="block px-4 py-2 text-sm text-[#6d5d4b] hover:bg-[#f4dcc7] rounded-md" data-lang="bn">ржмрж╛ржВрж▓рж╛ (Bengali)</a>
                    <a href="#" class="block px-4 py-2 text-sm text-[#6d5d4b] hover:bg-[#f4dcc7] rounded-md" data-lang="te">р░др▒Жр░▓р▒Бр░Чр▒Б (Telugu)</a>
                    <a href="#" class="block px-4 py-2 text-sm text-[#6d5d4b] hover:bg-[#f4dcc7] rounded-md" data-lang="mr">рдорд░рд╛рдареА (Marathi)</a>
                    <a href="#" class="block px-4 py-2 text-sm text-[#6d5d4b] hover:bg-[#f4dcc7] rounded-md" data-lang="ta">родрооро┐ро┤рпН (Tamil)</a>
                    <a href="#" class="block px-4 py-2 text-sm text-[#6d5d4b] hover:bg-[#f4dcc7] rounded-md" data-lang="gu">ркЧрлБркЬрк░рк╛ркдрлА (Gujarati)</a>
                    <a href="#" class="block px-4 py-2 text-sm text-[#6d5d4b] hover:bg-[#f4dcc7] rounded-md" data-lang="kn">р▓Хр▓ир│Нр▓ир▓б (Kannada)</a>
                    <a href="#" class="block px-4 py-2 text-sm text-[#6d5d4b] hover:bg-[#f4dcc7] rounded-md" data-lang="pa">рикрй░риЬри╛римрйА (Punjabi)</a>
                    <a href="#" class="block px-4 py-2 text-sm text-[#6d5d4b] hover:bg-[#f4dcc7] rounded-md" data-lang="ml">р┤ор┤▓р┤пр┤╛р┤│р┤В (Malayalam)</a>
                    <a href="#" class="block px-4 py-2 text-sm text-[#6d5d4b] hover:bg-[#f4dcc7] rounded-md" data-lang="or">рмУрмбрм╝рм┐рмЖ (Odia)</a>
                    <a href="#" class="block px-4 py-2 text-sm text-[#6d5d4b] hover:bg-[#f4dcc7] rounded-md" data-lang="as">ржЕрж╕ржорзАржпрж╝рж╛ (Assamese)</a>
                    <a href="#" class="block px-4 py-2 text-sm text-[#6d5d4b] hover:bg-[#f4dcc7] rounded-md" data-lang="ur">╪з╪▒╪п┘И (Urdu)</a>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Chat Area -->
    <main class="flex-1 flex flex-col items-center w-full overflow-y-auto">
        <div class="chat-container w-full max-w-4xl p-4">
            <div id="chat-messages">
                <div class="bot-message-container">
                    <div id="initial-bot-message" class="message-bubble bot-message">
                         Namaskar !  You can tell me about the issues or symptoms you are facing , or anything I can help you with regarding medical awareness.
                    </div>
                </div>
            </div>
             <p id="header-subtitle" class="text-sm text-gray-500 text-center mt-8">You can talk or type in any language and I will understand you.</p>
        </div>
    </main>

    <!-- Fixed Input Bar at Bottom -->
    <footer class="p-4 w-full">
        <div class="max-w-4xl mx-auto">
            <div class="input-area-container flex items-center">
                <input type="text" id="user-input" placeholder="Message Healthcare Chatbot..." class="flex-1 w-full bg-transparent border-none focus:outline-none text-gray-800 placeholder-gray-500">
                
                <button id="mic-btn" class="button-style p-2 rounded-full transition duration-300">
                     <svg id="mic-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" x2="12" y1="19" y2="22"></line></svg>
                </button>
                
                <button id="send-btn" class="button-style p-2 rounded-full transition duration-300">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path></svg>
                </button>
            </div>
        </div>
    </footer>

    <script>
        // DOM Elements
        const chatMessages = document.getElementById('chat-messages');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const micBtn = document.getElementById('mic-btn');
        const micIcon = document.getElementById('mic-icon');
        const chatContainer = document.querySelector('.chat-container');
        const headerTitle = document.getElementById('header-title');
        const headerSubtitle = document.getElementById('header-subtitle');
        const initialBotMessage = document.getElementById('initial-bot-message');
        
        // Custom Language Selector Elements
        const languageSelectorButton = document.getElementById('language-selector-button');
        const languagePanel = document.getElementById('language-panel');
        const selectedLanguageText = document.getElementById('selected-language-text');
        const languageOptions = languagePanel.querySelectorAll('a');


        // UI Translations
        const translations = {
            en: {
                title: 'Healthcare Chatbot',
                subtitle: 'You can talk or type in any language and I will understand you.',
                initial: 'Namaskar !  You can tell me about the issues or symptoms you are facing , or anything I can help you with regarding medical awareness.',
                placeholder: 'Message Healthcare Chatbot...'
            },
            'hi-EN': {
                title: 'Healthcare Chatbot',
                subtitle: 'Aap kisi bhi language mein baat kar sakte hain aur main samajh jaunga.',
                initial: 'Namaskar! Aap apni pareshani ya lakshan bata sakte hain.',
                placeholder: 'Yahan message karein...'
            },
            hi: {
                title: 'рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╕реЗрд╡рд╛ рдЪреИрдЯрдмреЙрдЯ',
                subtitle: 'рдЖрдк рдХрд┐рд╕реА рднреА рднрд╛рд╖рд╛ рдореЗрдВ рдмрд╛рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЯрд╛рдЗрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдореИрдВ рдЖрдкрдХреЛ рд╕рдордЭреВрдВрдЧрд╛ред',
                initial: 'рдирдорд╕реНрддреЗ! рдЖрдк рдЕрдкрдиреА рд╕рдорд╕реНрдпрд╛рдУрдВ рдпрд╛ рд▓рдХреНрд╖рдгреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрддрд╛ рд╕рдХрддреЗ рд╣реИрдВред',
                placeholder: 'рдпрд╣рд╛рдБ рд╕рдВрджреЗрд╢ рднреЗрдЬреЗрдВ...'
            },
            bn: {
                title: 'рж╕рзНржмрж╛рж╕рзНржерзНржпрж╕рзЗржмрж╛ ржЪрзНржпрж╛ржЯржмржЯ',
                subtitle: 'ржЖржкржирж┐ ржпрзЗржХрзЛржирзЛ ржнрж╛рж╖рж╛ржпрж╝ ржХржерж╛ ржмрж▓рждрзЗ ржмрж╛ ржЯрж╛ржЗржк ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржПржмржВ ржЖржорж┐ ржЖржкржирж╛ржХрзЗ ржмрзБржЭрждрзЗ ржкрж╛рж░ржмред',
                initial: 'ржиржорж╕рзНржХрж╛рж░! ржЖржкржирж┐ ржЖржкржирж╛рж░ рж╕ржорж╕рзНржпрж╛ ржмрж╛ рж▓ржХрзНрж╖ржг рж╕ржорзНржкрж░рзНржХрзЗ ржЖржорж╛ржХрзЗ ржмрж▓рждрзЗ ржкрж╛рж░рзЗржиред',
                placeholder: 'ржПржЦрж╛ржирзЗ ржмрж╛рж░рзНрждрж╛ ржкрж╛ржарж╛ржи...'
            },
            te: {
                title: 'р░Жр░░р▒Лр░Чр▒Нр░п р░╕р░Вр░░р░Хр▒Нр░╖р░г р░Ър░╛р░Яр▒НтАМр░мр░╛р░Яр▒Н',
                subtitle: 'р░ор▒Ар░░р▒Б р░П р░нр░╛р░╖р░▓р▒Лр░ир▒Ир░ир░╛ р░ор░╛р░Яр▒Нр░▓р░╛р░бр░╡р░Ър▒Нр░Ър▒Б р░▓р▒Зр░жр░╛ р░Яр▒Ир░кр▒Н р░Ър▒Зр░пр░╡р░Ър▒Нр░Ър▒Б р░ор░░р░┐р░пр▒Б р░ир▒Зр░ир▒Б р░ор░┐р░ор▒Нр░ор░▓р▒Нр░ир░┐ р░Ер░░р▒Нр░ер░В р░Ър▒Зр░╕р▒Бр░Хр▒Бр░Вр░Яр░╛р░ир▒Бред',
                initial: 'р░ир░ор░╕р▒Нр░Хр░╛р░░р░В! р░ор▒Ар░░р▒Б р░Ор░жр▒Бр░░р▒Нр░Хр▒Кр░Вр░Яр▒Бр░ир▒Нр░и р░╕р░ор░╕р▒Нр░пр░▓р▒Б р░▓р▒Зр░жр░╛ р░▓р░Хр▒Нр░╖р░гр░╛р░▓ р░Чр▒Бр░░р░┐р░Вр░Ър░┐ р░ор▒Ар░░р▒Б р░ир░╛р░Хр▒Б р░Ър▒Жр░кр▒Нр░кр░Чр░▓р░░р▒Бред',
                placeholder: 'р░Зр░Хр▒Нр░Хр░б р░╕р░Вр░жр▒Зр░╢р░В р░кр░Вр░кр░Вр░бр░┐...'
            },
            mr: {
                title: 'рдЖрд░реЛрдЧреНрдпрд╕реЗрд╡рд╛ рдЪреЕрдЯрдмреЙрдЯ',
                subtitle: 'рддреБрдореНрд╣реА рдХреЛрдгрддреНрдпрд╛рд╣реА рднрд╛рд╖реЗрдд рдмреЛрд▓реВ рд╢рдХрддрд╛ рдХрд┐рдВрд╡рд╛ рдЯрд╛рдЗрдк рдХрд░реВ рд╢рдХрддрд╛ рдЖрдгрд┐ рдореА рддреБрдореНрд╣рд╛рд▓рд╛ рд╕рдордЬреВрди рдШреЗрдИрдиред',
                initial: 'рдирдорд╕реНрдХрд╛рд░! рддреБрдореНрд╣реА рдЬреНрдпрд╛ рд╕рдорд╕реНрдпрд╛ рдХрд┐рдВрд╡рд╛ рд▓рдХреНрд╖рдгрд╛рдВрдЪрд╛ рд╕рд╛рдордирд╛ рдХрд░рдд рдЖрд╣рд╛рдд рддреНрдпрд╛рдмрджреНрджрд▓ рддреБрдореНрд╣реА рдорд▓рд╛ рд╕рд╛рдВрдЧреВ рд╢рдХрддрд╛ред',
                placeholder: 'рдпреЗрдереЗ рд╕рдВрджреЗрд╢ рдкрд╛рдард╡рд╛...'
            },
            ta: {
                title: 'роЪрпБроХро╛родро╛ро░ роЕро░роЯрпНроЯрпИ╨▒╨╛╤В',
                subtitle: 'роирпАроЩрпНроХро│рпН роОроирпНрод роорпКро┤ро┐ропро┐ро▓рпБроорпН рокрпЗроЪро▓ро╛роорпН роЕро▓рпНро▓родрпБ родроЯрпНроЯроЪрпНроЪрпБ роЪрпЖропрпНропро▓ро╛роорпН, роиро╛ройрпН роЙроЩрпНроХро│рпИрокрпН рокрпБро░ро┐роирпНродрпБроХрпКро│рпНро╡рпЗройрпНред',
                initial: 'ро╡рогроХрпНроХроорпН! роирпАроЩрпНроХро│рпН роОродро┐ро░рпНроХрпКро│рпНро│рпБроорпН рокро┐ро░роЪрпНроЪро┐ройрпИроХро│рпН роЕро▓рпНро▓родрпБ роЕро▒ро┐роХрпБро▒ро┐роХро│рпИрокрпН рокро▒рпНро▒ро┐ роОройрпНройро┐роЯроорпН роХрпВро▒ро▓ро╛роорпНред',
                placeholder: 'роЗроЩрпНроХрпЗ роЪрпЖропрпНродро┐ роЕройрпБрокрпНрокрпБроЩрпНроХро│рпН...'
            },
            gu: {
                title: 'рк╣рлЗрк▓рлНркеркХрлЗрк░ ркЪрлЗркЯркмрлЛркЯ',
                subtitle: 'ркдркорлЗ ркХрлЛркИрккркг ркнрк╛рк╖рк╛ркорк╛ркВ рк╡рк╛ркд ркХрк░рлА рк╢ркХрлЛ ркЫрлЛ ркЕркерк╡рк╛ ркЯрк╛ркЗркк ркХрк░рлА рк╢ркХрлЛ ркЫрлЛ ркЕркирлЗ рк╣рлБркВ ркдркоркирлЗ рк╕ркоркЬрлАрк╢ред',
                initial: 'ркиркорк╕рлНркдрлЗ! ркдркорлЗ ркЬрлЗ рк╕ркорк╕рлНркпрк╛ркУ ркЕркерк╡рк╛ рк▓ркХрлНрк╖ркгрлЛркирлЛ рк╕рк╛ркоркирлЛ ркХрк░рлА рк░рк╣рлНркпрк╛ ркЫрлЛ ркдрлЗркирк╛ рк╡рк┐рк╢рлЗ ркдркорлЗ ркоркирлЗ ркХрк╣рлА рк╢ркХрлЛ ркЫрлЛред',
                placeholder: 'ркЕрк╣рлАркВ рк╕ркВркжрлЗрк╢ ркорлЛркХрк▓рлЛ...'
            },
            kn: {
                title: 'р▓Жр▓░р│Лр▓Чр│Нр▓п р▓░р▓Хр│Нр▓╖р▓гр│Ж р▓Ър▓╛р▓Яр│НтАМр▓мр▓╛р▓Яр│Н',
                subtitle: 'р▓ир│Ар▓╡р│Б р▓пр▓╛р▓╡р│Бр▓жр│З р▓нр▓╛р▓╖р│Жр▓пр▓▓р│Нр▓▓р▓┐ р▓ор▓╛р▓др▓ир▓╛р▓бр▓мр▓╣р│Бр▓жр│Б р▓Ер▓ер▓╡р▓╛ р▓Яр│Ир▓кр│Н р▓ор▓╛р▓бр▓мр▓╣р│Бр▓жр│Б р▓ор▓др│Нр▓др│Б р▓ир▓╛р▓ир│Б р▓ир▓┐р▓ор│Нр▓ор▓ир│Нр▓ир│Б р▓Ер▓░р│Нр▓ер▓ор▓╛р▓бр▓┐р▓Хр│Кр▓│р│Нр▓│р│Бр▓др│Нр▓др│Зр▓ир│Жред',
                initial: 'р▓ир▓ор▓╕р│Нр▓Хр▓╛р▓░! р▓ир│Ар▓╡р│Б р▓Ор▓жр│Бр▓░р▓┐р▓╕р│Бр▓др│Нр▓др▓┐р▓░р│Бр▓╡ р▓╕р▓ор▓╕р│Нр▓пр│Жр▓Чр▓│р│Б р▓Ер▓ер▓╡р▓╛ р▓░р│Лр▓Чр▓▓р▓Хр│Нр▓╖р▓гр▓Чр▓│ р▓мр▓Чр│Нр▓Чр│Ж р▓ир│Ар▓╡р│Б р▓ир▓ир▓Чр│Ж р▓╣р│Зр▓│р▓мр▓╣р│Бр▓жр│Бред',
                placeholder: 'р▓Зр▓▓р│Нр▓▓р▓┐ р▓╕р▓Вр▓жр│Зр▓╢ р▓Хр▓│р│Бр▓╣р▓┐р▓╕р▓┐...'
            },
            pa: {
                title: 'ри╕ри┐ри╣рид ри╕рй░ринри╛ри▓ риЪрйИриЯримрйЛриЯ',
                subtitle: 'ридрйБри╕рйАриВ риХри┐ри╕рйЗ ри╡рйА ринри╛ри╕ри╝ри╛ ри╡ри┐рй▒риЪ риЧрй▒ри▓ риХри░ ри╕риХрижрйЗ ри╣рйЛ риЬри╛риВ риЯри╛риИрик риХри░ ри╕риХрижрйЗ ри╣рйЛ риЕридрйЗ риорйИриВ ридрйБри╣ри╛риирйВрй░ ри╕риориЭри╛риВриЧри╛ред',
                initial: 'ри╕рид ри╕рйНри░рйА риЕриХри╛ри▓! ридрйБри╕рйАриВ риорйИриирйВрй░ риЙри╣риири╛риВ риорйБрй▒рижри┐риЖриВ риЬри╛риВ ри▓рй▒риЫригри╛риВ римри╛ри░рйЗ рижрй▒ри╕ ри╕риХрижрйЗ ри╣рйЛ риЬри┐риирйНри╣ри╛риВ рижри╛ ридрйБри╕рйАриВ ри╕ри╛ри╣риоригри╛ риХри░ ри░ри╣рйЗ ри╣рйЛред',
                placeholder: 'риЗрй▒риерйЗ ри╕рйБриирйЗри╣ри╛ ринрйЗриЬрйЛ...'
            },
            ml: {
                title: 'р┤╣р╡Жр╡╜р┤др╡Нр┤др╡НтАМр┤Хр╡Жр┤пр╡╝ р┤Ър┤╛р┤▒р╡Нр┤▒р╡Нр┤мр╡Лр┤Яр╡Нр┤Яр╡Н',
                subtitle: 'р┤ир┤┐р┤Щр╡Нр┤Щр╡╛р┤Хр╡Нр┤Хр╡Н р┤Пр┤др╡Н р┤нр┤╛р┤╖р┤пр┤┐р┤▓р╡Бр┤В р┤╕р┤Вр┤╕р┤╛р┤░р┤┐р┤Хр╡Нр┤Хр┤╛р┤В р┤Ер┤▓р╡Нр┤▓р╡Жр┤Щр╡Нр┤Хр┤┐р╡╜ р┤Яр╡Ир┤кр╡Нр┤кр╡Н р┤Ър╡Жр┤пр╡Нр┤пр┤╛р┤В, р┤Юр┤╛р╡╗ р┤ор┤ир┤╕р╡Нр┤╕р┤┐р┤▓р┤╛р┤Хр╡Нр┤Хр╡Бр┤В.',
                initial: 'р┤ир┤ор┤╕р╡Нр┤Хр┤╛р┤░р┤В! р┤ир┤┐р┤Щр╡Нр┤Щр╡╛ р┤ир╡Зр┤░р┤┐р┤Яр╡Бр┤ир╡Нр┤и р┤кр╡Нр┤░р┤╢р╡Нр┤ир┤Щр╡Нр┤Щр┤│р╡Жр┤Хр╡Нр┤Хр╡Бр┤▒р┤┐р┤Ър╡Нр┤Ър╡Л р┤▓р┤Хр╡Нр┤╖р┤гр┤Щр╡Нр┤Щр┤│р╡Жр┤Хр╡Нр┤Хр╡Бр┤▒р┤┐р┤Ър╡Нр┤Ър╡Л р┤Ор┤ир╡Нр┤ир╡Лр┤Яр╡Н р┤кр┤▒р┤пр┤╛р┤В.',
                placeholder: 'р┤Зр┤╡р┤┐р┤Яр╡Ж р┤╕р┤ир╡Нр┤жр╡Зр┤╢р┤В р┤Ер┤пр┤пр╡НтАМр┤Хр╡Нр┤Хр╡Бр┤Х...'
            },
            or: {
                title: 'рм╕рнНрн▒рм╛рм╕рнНрмернНрнЯрм╕рнЗрммрм╛ рмЪрм╛рмЯрнНтАМрммрмЯрнН',
                subtitle: 'рмЖрмкрмг рмпрнЗрмХрнМрмгрм╕рм┐ рмнрм╛рм╖рм╛рм░рнЗ рмХрмерм╛рммрм╛рм░рнНрмдрнНрмдрм╛ рмХрм░рм┐рмкрм╛рм░рм┐рммрнЗ рмХрм┐рморнНрммрм╛ рмЯрм╛рмЗрмкрнН рмХрм░рм┐рмкрм╛рм░рм┐рммрнЗ рмПрммрмВ рморнБрмБ рмЖрмкрмгрмЩрнНрмХрнБ рммрнБрмЭрм┐рмкрм╛рм░рм┐рммрм┐ред',
                initial: 'рмирморм╕рнНрмХрм╛рм░! рмЖрмкрмг рм╕рм╛рморнНрмирм╛ рмХрм░рнБрмерм┐рммрм╛ рм╕рморм╕рнНрнЯрм╛ рмХрм┐рморнНрммрм╛ рм▓рмХрнНрм╖рмг рммрм┐рм╖рнЯрм░рнЗ рморнЛрмдрнЗ рмХрм╣рм┐рмкрм╛рм░рм┐рммрнЗред',
                placeholder: 'рмПрмарм╛рм░рнЗ рм╕рмирнНрмжрнЗрм╢ рмкрмарм╛рмирнНрмдрнБ...'
            },
            as: {
                title: 'рж╕рзНржмрж╛рж╕рзНржерзНржпрж╕рзЗрз▒рж╛ ржЪрзЗржЯржмржЯ',
                subtitle: 'ржЖржкрзБржирж┐ ржпрж┐ржХрзЛржирзЛ ржнрж╛рж╖рж╛ржд ржХржерж╛ ржкрж╛рждрж┐ржм ржмрж╛ ржЯрж╛ржЗржк ржХрз░рж┐ржм ржкрж╛рз░рзЗ ржЖрз░рзБ ржоржЗ ржЖржкрзЛржирж╛ржХ ржмрзБржЬрж┐ ржкрж╛ржоред',
                initial: 'ржиржорж╕рзНржХрж╛рз░! ржЖржкрзБржирж┐ рж╕ржирзНржорзБржЦрзАржи рж╣рзЛрз▒рж╛ рж╕ржорж╕рзНржпрж╛ ржмрж╛ рж▓ржХрзНрж╖ржгрж╕ржорзВрж╣рз░ ржмрж┐рж╖ржпрж╝рзЗ ржорзЛржХ ржХ\'ржм ржкрж╛рз░рзЗред',
                placeholder: 'ржЗржпрж╝рж╛ржд ржмрж╛рз░рзНрждрж╛ ржкрдард╛ржУржХ...'
            },
            ur: {
                title: '╪╡╪н╪к ┌й█М ╪п█М┌й┌╛ ╪и┌╛╪з┘Д ┌й╪з ┌Ж█М┘╣ ╪и┘И┘╣',
                subtitle: '╪в┘╛ ┌й╪│█М ╪и┌╛█М ╪▓╪и╪з┘Ж ┘Е█М┌║ ╪и╪з╪к ┌й╪▒ ╪│┌й╪к█Т █Б█М┌║ █М╪з ┘╣╪з╪ж┘╛ ┌й╪▒ ╪│┌й╪к█Т █Б█М┌║ ╪з┘И╪▒ ┘Е█М┌║ ╪в┘╛ ┌й┘И ╪│┘Е╪м┌╛ ┘Д┘И┌║ ┌п╪з█Ф',
                initial: '┘Ж┘Е╪│╪к█Т! ╪в┘╛ ┘Е╪м┌╛█Т ╪з┘Ж ┘Е╪│╪з╪ж┘Д █М╪з ╪╣┘Д╪з┘Е╪з╪к ┌й█Т ╪и╪з╪▒█Т ┘Е█М┌║ ╪и╪к╪з ╪│┌й╪к█Т █Б█М┌║ ╪м┘Ж ┌й╪з ╪в┘╛ ╪│╪з┘Е┘Ж╪з ┌й╪▒ ╪▒█Б█Т █Б█М┌║█Ф',
                placeholder: '█М█Б╪з┌║ ┘╛█М╪║╪з┘Е ╪и┌╛█М╪м█М┌║...'
            }
        };

        function updateUIText(lang) {
            const t = translations[lang];
            if (!t) return;
            headerTitle.textContent = t.title;
            headerSubtitle.textContent = t.subtitle;
            initialBotMessage.textContent = t.initial;
            userInput.placeholder = t.placeholder;
        }


        // State variables for voice recording
        let isRecording = false;
        let mediaRecorder;
        let audioChunks = [];
        const WEBHOOK_URL = 'http://localhost:5000/webhook';

        // --- Core Message and UI Functions ---
        function addMessage(text, sender) {
            const messageContainer = document.createElement('div');
            messageContainer.className = `${sender === 'user' ? 'user-message-container' : 'bot-message-container'}`;
            const messageBubble = document.createElement('div');
            messageBubble.className = `message-bubble ${sender === 'user' ? 'user-message' : 'bot-message'}`;
            messageBubble.textContent = text;
            messageContainer.appendChild(messageBubble);
            chatMessages.appendChild(messageContainer); // FIX: Append directly to the messages container
            chatContainer.parentElement.scrollTop = chatContainer.parentElement.scrollHeight; // Scroll main area
        }

        function showTypingIndicator() {
            const indicator = document.createElement('div');
            indicator.id = 'typing-indicator';
            indicator.className = 'bot-message-container';
            indicator.innerHTML = `<div class="message-bubble bot-message"><div class="flex items-center space-x-1"><div class="h-2 w-2 bg-gray-400 rounded-full animate-bounce [animation-delay:-0.3s]"></div><div class="h-2 w-2 bg-gray-400 rounded-full animate-bounce [animation-delay:-0.15s]"></div><div class="h-2 w-2 bg-gray-400 rounded-full animate-bounce"></div></div></div>`;
            chatMessages.appendChild(indicator); // FIX: Append directly to the messages container
            chatContainer.parentElement.scrollTop = chatContainer.parentElement.scrollHeight;
        }

        function removeTypingIndicator() {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) indicator.remove();
        }
        
        // --- Text-to-Speech Function ---
        function speakText(text, lang) {
            try {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = lang || 'en-US';
                window.speechSynthesis.speak(utterance);
            } catch (error) {
                console.error("Browser Text-to-Speech failed:", error);
            }
        }

        // --- Text Message Handling ---
        async function sendTextMessage() {
            const userText = userInput.value.trim();
            if (userText === '') return;
            
            // Hide initial message and subtitle if they are visible
            if(initialBotMessage.parentElement.style.display !== 'none') {
                initialBotMessage.parentElement.style.display = 'none';
                headerSubtitle.style.display = 'none';
            }

            addMessage(userText, 'user');
            userInput.value = '';
            showTypingIndicator();

            try {
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: userText, sender: 'web-text-user' })
                });

                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                
                const data = await response.json();
                removeTypingIndicator();
                addMessage(data.response, 'bot');
                speakText(data.response, data.language);

            } catch (error) {
                console.error('Error sending message:', error);
                removeTypingIndicator();
                let errorText = "Sorry, I couldn't connect. Please ensure the Python webhook server is running.";
                 if (window.location.protocol === 'https:') {
                    errorText = "Error: This secure page (HTTPS) cannot connect to the local server (HTTP). Please run this HTML file directly from your computer's folder to fix this.";
                }
                addMessage(errorText, 'bot');
            }
        }

        // --- Voice Message Handling ---
        async function handleMicClick() {
            if (isRecording) {
                mediaRecorder.stop();
                isRecording = false;
                micBtn.classList.remove('recording-animation', 'text-red-600');
            } else {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    mediaRecorder = new MediaRecorder(stream, { mimeType: 'audio/webm;codecs=opus' });
                    audioChunks = [];

                    mediaRecorder.ondataavailable = event => audioChunks.push(event.data);
                    
                    mediaRecorder.onstop = async () => {
                        if(initialBotMessage.parentElement.style.display !== 'none') {
                           initialBotMessage.parentElement.style.display = 'none';
                           headerSubtitle.style.display = 'none';
                        }
                        
                        const audioBlob = new Blob(audioChunks, { type: 'audio/webm;codecs=opus' });
                        const formData = new FormData();
                        formData.append('audio', audioBlob, 'recording.webm');
                        formData.append('sender', 'web-voice-user');

                        showTypingIndicator();
                        
                        try {
                            const response = await fetch(WEBHOOK_URL, { method: 'POST', body: formData });
                            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                            
                            const data = await response.json();
                            addMessage(`ЁЯОд "${data.transcribed_text}"`, 'user');
                            removeTypingIndicator();
                            addMessage(data.response, 'bot');
                            speakText(data.response, data.language);

                        } catch(error) {
                             console.error('Error sending audio:', error);
                             removeTypingIndicator();
                             let errorText = "Sorry, error processing voice. Ensure Python server is running.";
                              if (window.location.protocol === 'https:') {
                                errorText = "Error: This secure page (HTTPS) cannot send audio to the local server (HTTP). Please run this HTML file directly from your computer to fix this.";
                             }
                             addMessage(errorText, 'bot');
                        } finally {
                            stream.getTracks().forEach(track => track.stop());
                        }
                    };

                    mediaRecorder.start();
                    isRecording = true;
                    micBtn.classList.add('recording-animation', 'text-red-600');

                } catch (error) {
                    console.error("Microphone access denied:", error);
                    alert("Microphone access is required. Please allow permission and refresh.");
                }
            }
        }

        // --- Event Listeners ---
        sendBtn.addEventListener('click', sendTextMessage);
        userInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') sendTextMessage();
        });
        micBtn.addEventListener('click', handleMicClick);
        
        // --- Custom Language Dropdown Logic ---
        function toggleLanguagePanel() {
            if (languagePanel.classList.contains('hidden')) {
                languagePanel.classList.remove('hidden');
                setTimeout(() => {
                    languagePanel.classList.remove('scale-y-0', 'opacity-0');
                }, 10);
            } else {
                languagePanel.classList.add('scale-y-0', 'opacity-0');
                setTimeout(() => {
                    languagePanel.classList.add('hidden');
                }, 200);
            }
        }

        languageSelectorButton.addEventListener('click', toggleLanguagePanel);

        languageOptions.forEach(option => {
            option.addEventListener('click', (e) => {
                e.preventDefault();
                const lang = option.getAttribute('data-lang');
                const langText = option.textContent;
                selectedLanguageText.textContent = langText;
                updateUIText(lang);
                toggleLanguagePanel();
            });
        });

        // Close dropdown if clicked outside
        window.addEventListener('click', (e) => {
            const selector = document.getElementById('custom-language-selector');
            if (!selector.contains(e.target)) {
                if (!languagePanel.classList.contains('hidden')) {
                     languagePanel.classList.add('scale-y-0', 'opacity-0');
                    setTimeout(() => {
                        languagePanel.classList.add('hidden');
                    }, 200);
                }
            }
        });


    </script>

</body>
</html>

